---
date: 2023-12-19
today: Spring Filter 개념에 대해 설명할 수 있다
---

## Filter

들어오는 요청과 나가는 응답에 대해 실행되는 Java 클래스이다.
요청이 Spring 프레임워크에 도달하기 전과 응답이 클라이언트에 도달하기 전에 수행되는 로직을 작성할 수 있는 장소이다. 그래서 보안 검사나 인증 및 인가 같은 작업을 하기가 좋은 위치이다.
요청이 들어오면 웹서버(tomcat)은 이 요청을 디스패처 서블릿으로 포워딩한다. 디스패처 서블릿은 핸들러 맵핑 메소드를 통해서 컨트롤러를 보낸다.
필터는 웹 컨테이너와 디스패처 서블릿 사이에 위치한다.
필터는 여러 개를 사용할 수 있고, 이걸 필터 체인이라고 한다.
이 필터 체인에서 들어오거나 나가는 요청을 차단할 수 있고, 이 경우에 끝까지 도달하지 못하고 조기 반환된다.

Filter를 Bean으로 등록할 경우 스프링 컨테이너가 관리하고, 아닐 경우 서블릿 컨테이너가 관리한다.
**서블릿 컨테이너로 관리했을 때 장점 :**

- 간편한 설정 - xml 등으로 Filter를 등록하고 관리하는 것이 직관적이다.
- 서블릿 스펙 준수 - 어플리케이션을 표준적으로 유지 가능하다.
- 경량화된 구현
- 단순한 횡단 처리 가능 - 복잡하지 않은 로깅, 인코딩 등 가볍게 처리
- 호환성 - 스프링이 아닌 다른 컨테이너를 사용할 때 호환성 좋음

**스프링 컨테이너로 관리했을 때 장점 :**

- 의존성 주입 가능
- AOP 적용 가능
- Java Config를 통해 간편하게 빈의 프로퍼티 설정
- 컴포넌트 재사용

## OncePerRequestFilter

Filter는 매 요청을 받을 때마다 실행되는데, 딱 한 번만 실행해도 되는 Filter들이 있다. 인증이나 인가 같은 것들. 이미 인증된 유저인데 중복 로직을 수행하는 것은 리소스 낭비이기 때문에, 요청 당 한 번만 실행하는 Filter인 OncePerRequestFilter를 적용할 수 있다.
Filter는 인터페이스이지만, OncePerRequestFilter는 구체클래스이다.
