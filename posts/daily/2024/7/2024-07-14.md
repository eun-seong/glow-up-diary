---
date: 2024-07-14
today:
---
## 채팅 기능에서 사용자 인증

Firestore를 사용하기로 결정하면서, 사용자 인증에 대한 부분이 고민이 된다.
먼저, 인증 시기에 대해서는 메세지를 주고 받을 때마다 인증을 거쳐야 하는건지? 소켓 첫 연결 시에만 인증하면 되는지?
그리고 방법에 대해서는 어떤 기준을 통해 Cloud Function으로 트리거하여 인증을 수행하거나? Spring 서버로 직접 인증된 사용자인지 확인하거나?

메세지를 보낼 때마다 인증을 하는 건 비용적으로 무리일 것 같았다. 첫 연결 시와 주기적으로 인증을 수행하는 게 좋겠다고 판단함.
문제는 방법이다.
메인 서버로 인증한다면, 인증이 성공했다는 것을 응답받은 후에 소켓 연결을 하게 될 텐데... 이게 분리되어 있다는 게 보안적인 면에서 아쉽다.
만약 Cloud Function을 사용한다면, 그 함수에서 스프링 서버로 http 요청을 보낼텐데 그럼 레이턴시가 길어진다는 문제가 있지만? 첫 연결에만 한다면 나쁘지 않을지도?


