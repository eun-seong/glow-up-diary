---
date: 2024-03-19
today:
---
## 알고리즘
- [BOJ - ]()
- [BOJ - ]()

---


## 여러 번 같은 피드백을 들었다

이번에 남의위키 리팩토링을 하면서 깨달은 점이 몇 가지 있다.

1. 소통이 부족했다.
어떤 부분에 대해서 리팩토링을 진행한다는 것을 팀원에게 공유는 했다. 그리고 리팩토링을 진행했는데, 이게 하다보니 규모가 점점 커져서 엄청나게 복잡해졌다.
리팩토링을 모두 끝내고 PR을 올려서 리뷰 요청을 했다. PR 본문을 작성하면서 뭔가 잘못되었다는 걸 알았다.
코드를 작성한 과정과 결과, 그렇게 했던 이유 등 모든 것이 내 머릿속에는 있는데, 글로 작성하려니 잘 안되었다.

그리고 역시나 팀원도 이해하지 못했다.

나는 리팩토링 규모가 꽤 커진다는 생각이 들었을 때, 어떤 점이 문제인지 정리해서 먼저 공유했어야 했다.
(하지만 약간의 변명을 하자면... 리팩토링을 하면서 발견된 문제도 많았다. 지금와서 문제점을 잘 정리할 수 있는 이유는 리팩토링을 진행했기 때문이다)
공유를 하고, 팀원의 의견을 다시 물어서 리팩토링 방향을 정했어야 했다.

내가 굳이굳이 리팩토링을 강행했던 이유는 내 욕심 때문이다.
이번이 백엔드 개발이 처음이라서 잘 하고 싶은 마음도 있었고, 여러 가지 시도해보고 싶은 마음도 있었다.
리팩토링도 그 중 하나였고 내가 꼭 해결하고 싶었던 부분이라 욕심이 과했던 것 같다.


> 이슈가 있으면 끊임없이 동료와 논의하자. 이슈는 고정되어 있는 것이 아니라 살아있는 것이다.


2. 리팩토링은 천천히 하나씩 진행해야 한다.
작업 자체는 나 혼자 스텝을 나누고 하나씩 진행했다. 그런데 이 스텝이 순서가 꼭 필요한 것이라서 이슈를 나누는 게 큰 의미가 없다고 생각했다. 왜냐면 이슈를 나눠서 브랜치를 나누더라도, 이전 이슈가 dev로 머지가 안된 상태일 거고 그럼 어차피 그 이전 이슈에서 브랜치를 따와서 작업을 해야 하니까. 커밋으로 나누면 충분할 거라 생각했다.
그리고 볼륨이 커지니 코드가 실시간으로 변하고 있는 상황에서 리팩토링한다는 게 쉽지 않았다. 변경될 때마다 내 리팩토링 브랜치가 영향을 받는 코드가 많아져서 conflict가 계속 발생했다.

그렇게 모든 작업이 합쳐지니 PR을 본 팀원은 뚱딴지 같은 코드를 보게된 것이다. 

그래서 어떻게 해결할 수 있을까 고민을 해봤다.
리팩토링 방향성이 정해지고 해당 리팩토리의 이름이 정해졌다면, 하위 작업을 나누어서 리팩토리 브랜치에 머지하는 방식은 어떨까?
예를 들어, `refactor/#120`이 리팩토링 대표 브랜치 이름이라고 치자. 그럼 하위 task를 나누어서 이슈를 만들고 그 이름을 `refactor/#120/#122` 로 작업하는 것이다.

`refactor/#120`은 dev에서 체크아웃된 브랜치이고 리팩토링에 중심이 되는 브랜치이다. 그럼 하위 task가 완료되면 `refactor/#120` 브랜치로 머지하면 되고, 모든 작업이 끝나면 `refactor/#120` 브랜치를 dev로 머지하면 되는 것이다.
이렇게 하면 작업하는 사람도 동료도 편할 것 같다.
한 스텝 밟아가면서 피드백 받고, 천천히 그리고 차분하게 작업할 수 있겠다.


> 리팩토링은 하나씩 해결한다. 


3. 이번이 3번째. 같은 피드백을 들었다.

확장성을 고려해서 모든 것을 하나에 수용하려는 것은 좋지 않다는 피드백을 벌써 3번째 받았다.

첫 번째는 이전 직장에서. 어떤 내용이었는지 정확히 기억은 안나는데, 어떤 컴포넌트를 만들었고 리뷰하는 과정에서 저걸 굳이 저렇게까지 할 필요가 있냐는 말을 들었다. 너무 과도한 모듈화도 좋지 않다는 평이었다.

두 번째는 개인 프로젝트 진행하면서 드는 궁금증을 친구에게 물어봤을 때이다. 그룹 채팅 내에서 생성하는 리소스가 있다. 이 리소스는 해당 그룹에 종속되는 걸로 설계를 하긴했는데, 나중에 그룹 채팅이 아니라 사용자 별로 개인적인 리소스를 생성할 수 있게 되면 어떡하냐 라는 질문을 했다. 그 친구는 그건 완전히 다른 도메인으로 봐야 한다고 했다. 너무 하나에 다 넣어서 범용적이게 할 필요 없고, 그렇게 하는 게 오히려 독이 된다고.

세 번째는 이 리팩토링 과정에서 팀원에게서 들었다. 사용자에게 받은 설문의 응답으로 통계량을 계산한다. 이 통계량에는 사용자 개별 통계와 전체 사용자 통계로 나뉜다. 이 둘을 합치자는 의견을 제시해주셨고, 내가 "추후에 만약 전체 사용자 통계가 문항별로 하나씩 생기는 게아니라, 여러 문항이 합쳐진 형태로 계산되는 게 있을 수 있는데 둘을 어떻게 합치냐"고 되물었다. 팀원은 그런 상황이 오면 그건 다른 테이블을 만들어야 한다고, 너무 하나에 넣을 필요 없다고 답했다.


이 세 경험 모두 공통점이 있다. 내가 너무 확장성 확장성 하면서 "만약에무새"가 된 것이다.
평소에 상상력도 별로 없고 창의적이지도 않으면서, 꼭 이렇게 코드 작성하고 설계할 때만 되면 혼자 만약에 게임하고 있다.

이건 내가 아직까지 무언가를 정의하는 능력이 많이 부족하다는 것 밖에 할 말이 없다.
객체 쪼개기를 잘 해야 하는데 뭐든 다 하는 맥가이버칼 같은 객체를 만들려고 하는 것 같다... 근데 또 단순히 객체 레벨의 문제는 아니고 전반적인 설계 능력이 좀 떨어지는 것 같기도 하고...

어쩄든 책 읽고 고민 하고 코드 짜보고 이러면서 개선해야 할 부분이다.


> 확장성도 좋지만, SRP를 잊지 말자.



